<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Switching clusters - IBM Event Automation</title>
<meta name="description" content="Using geo-replication to recover when clusters become unavailable.">

<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="IBM Event Automation">
<meta property="og:url" content="http://localhost:4000/event-automation/es/es_10.5/georeplication/failover/" />
<meta property="og:title" content="Event Streams | Switching clusters" />
<meta property="og:description" content="Using geo-replication to recover when clusters become unavailable." />

<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="IBM Event Automation | Switching clusters" />




  <meta property="og:description" content="Using geo-replication to recover when clusters become unavailable.">



  <meta property="og:image" content="http://localhost:4000/event-automation/assets/siteMeta/appIcon_og_fb.png">
  <meta name="twitter:image" content="http://localhost:4000/event-automation/assets/siteMeta/appIcon_og_square.png">



  <meta property="article:published_time" content="2023-06-28T12:13:19-04:00">






<link rel="canonical" href="http://localhost:4000/event-automation/es/es_10.5/georeplication/failover/">





  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "http://localhost:4000/event-automation",
      "logo": "http://localhost:4000/event-automation/assets/siteMeta/appIcon_og_fb.png"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": null,
      "url": "http://localhost:4000/event-automation",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/event-automation/feed.xml" type="application/atom+xml" rel="alternate" title="IBM Event Automation Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/event-automation/assets/css/main.css">



<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/event-automation/assets/siteMeta/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:4000/event-automation/assets/siteMeta/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:4000/event-automation/assets/siteMeta/favicon-16x16.png">
<link rel="manifest" href="http://localhost:4000/event-automation/assets/siteMeta/site.webmanifest">
<link rel="mask-icon" href="http://localhost:4000/event-automation/assets/siteMeta/safari-pinned-tab.svg" color="#000000">
<link rel="shortcut icon" href="http://localhost:4000/event-automation/assets/siteMeta/favicon.ico">
<link rel="shortcut icon" type="image/png" href="http://localhost:4000/event-automation/assets/siteMeta/favicon-16x16.png"/>
<link rel="shortcut icon" type="image/png" href="http://localhost:4000/event-automation/assets/siteMeta/favicon-32x32.png"/>
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-config" content="http://localhost:4000/event-automation/assets/siteMeta/browserconfig.xml">
<meta name="theme-color" content="#000000">



<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,600%7CIBM+Plex+Serif:300,400,500%7CIBM+Plex+Mono:300,400,500,700" rel="stylesheet">

<!-- end custom head snippets -->

    <link rel="shortcut icon" type="image/x-icon" href="/event-automation/assets/favicon.ico" >
    
    <base target="_parent">

  </head>
  <script src="/event-automation/assets/animation/lottie.js" type="text/javascript"></script>
  <script src="/event-automation/assets/js/connectors.js"></script>


  
  <body onload="urlChecker()" class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    




<div id="masthead" class="masthead">
  <!--
  <div class="masthead__goToIBMCloud">
  <div>
    You are viewing the documentation for the container-native version of IBM Event Automation.
  </div>
    <a class="link" target="_self" href="https://cloud.ibm.com/docs/EventStreams?topic=EventStreams-getting-started">Looking for the managed service on IBM Cloud? Click here.</a>
</div>
-->
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="mastheadNav">

      


        <div class="mastheadTitle">
          
          <a class="site-title" href="/event-automation/" target="_self"><span>IBM</span>&nbsp;Event Automation</a>
          <div class="viewOnIBMcom">
            <a href="https://www.ibm.com/products/event-automation" target="_blank">View product page</a>
          </div>
        </div>









        <div class="mastheadControls">
            <div class="menuScrollContainer">

        

                <ul id="visible-links" class="visible-links">
                  
                  
                  

                  




                  
                    <li class="masthead__menu-item active" onclick="window.open('http://localhost:4000/event-automation/es/','_self')">
                      <a href="http://localhost:4000/event-automation/es/" >Event Streams</a>
                    </li>
                  

                  
                  
                  

                  




                  
                    <li class="masthead__menu-item " onclick="window.open('http://localhost:4000/event-automation/eem/','_self')">
                      <a href="http://localhost:4000/event-automation/eem/" >Endpoint Management</a>
                    </li>
                  

                  
                  
                  

                  




                  
                    <li class="masthead__menu-item " onclick="window.open('http://localhost:4000/event-automation/ep/','_self')">
                      <a href="http://localhost:4000/event-automation/ep/" >Event Processing</a>
                    </li>
                  

                  
                  
                  

                  




                  
                    <li class="masthead__menu-item " onclick="window.open('http://localhost:4000/event-automation/connectors/','_self')">
                      <a href="http://localhost:4000/event-automation/connectors/" >Connectors</a>
                    </li>
                  

                  
                  
                  

                  




                  
                    <li class="masthead__menu-item " onclick="window.open('http://localhost:4000/event-automation/tutorials/','_self')">
                      <a href="http://localhost:4000/event-automation/tutorials/" >Tutorials</a>
                    </li>
                  

                  
                  
                  

                  




                  
                    <li class="masthead__menu-item " onclick="window.open('http://localhost:4000/event-automation/api/','_self')">
                      <a href="http://localhost:4000/event-automation/api/" >APIs...</a>
                    </li>
                  

                  
                  
                  

                  




                  
                    <li class="masthead__menu-item " onclick="window.open('http://localhost:4000/event-automation/support/','_self')">
                      <a href="http://localhost:4000/event-automation/support/" >Support</a>
                    </li>
                  

                  
                  
                  

                  




                  
                    <li class="masthead__menu-item " onclick="window.open('http://localhost:4000/event-automation/search/','_self')">
                      <button aria-label="Search Button" role="button" id="searchButton" class="search__toggle " type="button" name="search Button">
                        <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                          <path
                            d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z"
                            transform="translate(-.01)"></path>
                        </svg>
                      </button>
                    </li>
                  

                  
                </ul>
        

      </div>
    </div>
      </nav>
    </div>
  </div>
</div>


    <div id="initial-content" class="initial-content" role="main">






<main id="main" class="mainContainer" role="main">
    
      <div id="subMenu" class="subMenu">
        <div tabindex="0" class="menuIcon" id="menuIcon">
          <svg id="mobileMenu" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
            <g id="bottomLine">
              <line class="burgerLine" x1="14" y1="29" x2="34" y2="29" />
            </g>
            <g id="middleLine">
              <line class="burgerLine" x1="14" y1="24" x2="34" y2="24" />
            </g>
            <g id="topLine">
              <line class="burgerLine" x1="14" y1="19" x2="34" y2="19" />
            </g>
          </svg>
        </div>
        <div id="mobileVersionShortcut" class="versionContainer" tabindex="0">
          <a id="mobileVersionPillCurrent" class="versionPill">10.5</a>
        </div>
      </div>
    
  



<div id="sidebarMask" class="sidebarMask">

  </div>
  <div id="sidebar" class="sidebar sticky">
      <div aria-label="Change Version" role="button" aria-expanded="false"
      
        id="versionDropdown"
        tabindex="0"
        class="versionsBar"
       >
          <div class="selectedVersion" id="selectedVersion">
            <div class="versionContainer" >
              
                <a id="versionPillCurrent" class="versionPill">10.5</a>
                <a class="versionChange">Change Version</a>
              
            </div>
          </div>
          


          <div class="allVersions" id="allVersions">
            <ul>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/georeplication/failover/" onclick="openVersion('/event-automation/es/georeplication/failover/','es_11.2')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/georeplication/failover/" class="versionPill inactive">11.2</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        Latest
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_11.1/georeplication/failover/" onclick="openVersion('/event-automation/es/es_11.1/georeplication/failover/','es_11.1')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_11.1/georeplication/failover/" class="versionPill inactive">11.1</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_11.0/georeplication/failover/" onclick="openVersion('/event-automation/es/es_11.0/georeplication/failover/','es_11.0')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_11.0/georeplication/failover/" class="versionPill inactive">11.0</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_10.5/georeplication/failover/" onclick="openVersion('/event-automation/es/es_10.5/georeplication/failover/','es_10.5')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_10.5/georeplication/failover/" class="versionPill active">10.5</a>
                      </div>
                      <div class="activeContainer">
                        
                          <img alt="" src="http://localhost:4000/event-automation/images/checkbox.svg" />
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_10.4/georeplication/failover/" onclick="openVersion('/event-automation/es/es_10.4/georeplication/failover/','es_10.4')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_10.4/georeplication/failover/" class="versionPill inactive">10.4</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_10.3/georeplication/failover/" onclick="openVersion('/event-automation/es/es_10.3/georeplication/failover/','es_10.3')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_10.3/georeplication/failover/" class="versionPill inactive">10.3</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_10.2/georeplication/failover/" onclick="openVersion('/event-automation/es/es_10.2/georeplication/failover/','es_10.2')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_10.2/georeplication/failover/" class="versionPill inactive">10.2</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_10.1/georeplication/failover/" onclick="openVersion('/event-automation/es/es_10.1/georeplication/failover/','es_10.1')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_10.1/georeplication/failover/" class="versionPill inactive">10.1</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_10.0/georeplication/failover/" onclick="openVersion('/event-automation/es/es_10.0/georeplication/failover/','es_10.0')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_10.0/georeplication/failover/" class="versionPill inactive">10.0</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_2019.4/georeplication/failover/" onclick="openVersion('/event-automation/es/es_2019.4/georeplication/failover/','es_2019.4')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_2019.4/georeplication/failover/" class="versionPill inactive">2019.4</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_2019.2.1/georeplication/failover/" onclick="openVersion('/event-automation/es/es_2019.2.1/georeplication/failover/','es_2019.2.1')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_2019.2.1/georeplication/failover/" class="versionPill inactive">2019.2.1</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_2019.1.1/georeplication/failover/" onclick="openVersion('/event-automation/es/es_2019.1.1/georeplication/failover/','es_2019.1.1')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_2019.1.1/georeplication/failover/" class="versionPill inactive">2019.1.1</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

                        


                    
                    
                    

                    

                    <li class="version" data-url="/event-automation/es/es_2018.3.1/georeplication/failover/" onclick="openVersion('/event-automation/es/es_2018.3.1/georeplication/failover/','es_2018.3.1')">
                      <div class="pillContainer">
                        
                        <a tabindex="-1" href="/event-automation/es/es_2018.3.1/georeplication/failover/" class="versionPill inactive">2018.3.1</a>
                      </div>
                      <div class="activeContainer">
                        
                      </div>
                      <div class="latest">
                        
                      </div>
                    </li>

                

            </ul>
          </div>
        </div>

  
    
      
      
      
    
    
      

<nav class="nav__list">
  
  <ul class="nav__items">

    
      <li>
        
          <span class="nav__sub-title">About</span>
        

        
        <ul>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/about/overview/" class="">Introduction</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/about/whats-new/" class="">What's new</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/about/key-concepts/" class="">Key concepts</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/about/producing-messages/" class="">Producing messages</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/about/consuming-messages/" class="">Consuming messages</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/about/partition-leadership/" class="">Partition leadership</a>
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Installing and upgrading</span>
        

        
        <ul>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/trying-out/" class="">Trying out Event Streams</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/prerequisites/" class="">Prerequisites</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/planning/" class="">Planning your installation</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/capacity-planning/" class="">Performance and capacity planning</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/preparing-multizone/" class="">Preparing for multizone clusters</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/installing/" class="">Installing</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/configuring/" class="">Configuring</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/post-installation/" class="">Post-installation tasks</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/moving-from-oss-kafka/" class="">Migrating from open-source Kafka</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/uninstalling/" class="">Uninstalling</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/upgrading/" class="">Upgrading and migrating</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/installing/migrating-to-apicurio/" class="">Migrating to Apicurio Registry</a>
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Getting started</span>
        

        
        <ul>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/getting-started/logging-in/" class="">Logging in</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/getting-started/creating-topics/" class="">Creating a Kafka topic</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/getting-started/generating-starter-app/" class="">Running a starter application</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/getting-started/testing-loads/" class="">Creating and testing message loads</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/getting-started/client/" class="">Creating Kafka client applications</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/getting-started/connecting/" class="">Connecting clients</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/getting-started/using-kafka-console-tools/" class="">Using Apache Kafka console tools</a>
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Schemas</span>
        

        
        <ul>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/schemas/overview/" class="">Schemas overview</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/schemas/creating/" class="">Creating and adding schemas</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/schemas/manage-lifecycle/" class="">Managing schema lifecycle</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/schemas/setting-java-apps/" class="">Setting Java applications to use schemas</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/schemas/setting-nonjava-apps/" class="">Setting non-Java applications to use schemas</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/schemas/migrating/" class="">Migrating to Event Streams schema registry</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/schemas/using-with-rest-producer/" class="">Using schemas with the REST producer API</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/schemas/setting-java-apps-apicurio-serdes/" class="">Setting Java applications to use schemas with the Apicurio Registry serdes library</a>
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Security</span>
        

        
        <ul>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/security/managing-access/" class="">Managing access</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/security/encrypting-data/" class="">Encrypting your data</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/security/secure-jmx-connections/" class="">Configuring secure JMX connections</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/security/network-policies/" class="">Network policies</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/security/gdpr-considerations/" class="">Considerations for GDPR</a>
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Geo-replication</span>
        

        
        <ul>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/georeplication/about/" class="">About geo-replication</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/georeplication/planning/" class="">Planning for geo-replication</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/georeplication/setting-up/" class="">Setting up geo-replication</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/georeplication/health/" class="">Monitoring and managing geo-replication</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/georeplication/failover/" class="active">Switching clusters</a>
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Connecting external systems</span>
        

        
        <ul>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/connecting/rest-api/" class="">Event Streams producer API</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/connecting/connectors/" class="">Kafka Connect and connectors</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/connecting/setting-up-connectors/" class="">Setting up and running connectors</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/connecting/mq/" class="">Connecting to IBM MQ</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/connecting/mq/source/" class="">Running the MQ source connector</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/connecting/mq/sink/" class="">Running the MQ sink connector</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/connecting/mq/zos/" class="">Running connectors on IBM z/OS</a>
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Administering</span>
        

        
        <ul>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/deployment-health/" class="">Monitoring deployment health</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/cluster-health/" class="">Monitoring Kafka cluster health</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/topic-health/" class="">Monitoring topic health</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/consumer-lag/" class="">Monitoring consumer group lag</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/tracing/" class="">Monitoring applications with distributed tracing</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/external-monitoring/" class="">Monitoring with external tools</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/modifying-installation/" class="">Modifying installation settings</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/cruise-control/" class="">Optimizing Kafka cluster with Cruise Control</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/scaling/" class="">Scaling</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/quotas/" class="">Setting client quotas</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/managing-multizone/" class="">Managing a multizone setup</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/administering/stopping-starting/" class="">Stopping and starting Event Streams</a>
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Troubleshooting</span>
        

        
        <ul>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/intro/" class="">Troubleshooting overview</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/gathering-logs/" class="">Gathering logs</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/resources-not-available/" class="">Resources not available</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/georeplication-error/" class="">Error when creating multiple geo-replicators</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/kafka-producer-error/" class="">TimeoutException when using standard Kafka producer</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/kafka-consumer-hangs/" class="">Standard Kafka consumer hangs</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/cloudctl-es-not-registered/" class="">Command 'cloudctl es' fails with 'not a registered command' error</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/cloudctl-es-fails/" class="">Command 'cloudctl es' produces 'FAILED' message</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/chrome-ubuntu-issue/" class="">UI does not open when using Chrome on Ubuntu</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/error-removing-destination/" class="">Unable to remove destination cluster</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/ui-403-error/" class="">403 error when signing in</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/problem-with-piping/" class="">The UI cannot load data</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/firefox-black-images/" class="">UI shows black images in Firefox</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/default-scc-issues/" class="">Event Streams not installing due to Security Context Constraint (SCC) issues</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/schema-registry-not-authorized-error/" class="">Not authorized error when building maven schema registry project</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/authorization-failed-exceptions/" class="">Client receives AuthorizationException when communicating with brokers</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/504-ui-consumer-groups/" class="">504 timeout error when viewing consumer groups in the Event Streams UI</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/kafka-exporter-not-deployed/" class="">Kafka exporter is not deployed</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/overriding-route-hostnames/" class="">Unable to override external listener route host</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/metrics-not-available/" class="">Event Streams metrics unavailable</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/failed-status-during-cs-install/" class="">Event Streams installation reports failed status</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/kcs2i-airgapped/" class="">KafkaConnectS2I build fails in an air-gapped installation</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/no-metrics-ui/" class="">Metrics do not display in operator Grafana dashboard</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/admin-api-mount-failure/" class="">Admin API pod does not start when using OpenShift 4.6</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/pkcs12-keystore-java-client/" class="">Client receives 'Failed to load SSL keystore' message when communicating with brokers</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/foundational-services-320-upgrade-block/" class="">Foundational services 3.20 blocks upgrade to Event Streams 11.0.x</a>
            </li>
          
            
            

            
            


      

            

            <li>


          

                    

              <a href="/event-automation/es/es_10.5/troubleshooting/watched-namespace/" class="">Apicurio authentication errors due to User Operator watchedNamespace</a>
            </li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <div class="mainContent">
    
    <div id="pageContainer" class="page" itemscope itemtype="http://schema.org/CreativeWork">
      
      <div class="page__inner-wrap">
      

        
        <section class="page__content pageSpacing" itemprop="text">
          
        
          <header>
            <h1 id="page-title" class="page__title" itemprop="headline">
              Switching clusters
</h1>
            
          </header>  
        
        

                    
          <div class="content">
            <p>When one of your origin Event Streams clusters experiences problems and becomes unavailable, you can switch your client applications over to use the geo-replicated topics on your destination Event Streams cluster.</p>

<p>Ensure you <a href="../planning/">plan for geo-replication</a> before <a href="../setting-up/">setting it up</a>.</p>

<h2 id="preparing-clusters-and-applications-for-switching">Preparing clusters and applications for switching</h2>

<p>To make switching of clusters require little intervention, consider the following guidance when preparing your Event Streams clusters and applications.</p>

<h3 id="configure-your-applications-for-switching">Configure your applications for switching</h3>

<p>Set up your applications so that reconfiguring them to switch clusters is as easy as possible. Code your applications so that security credentials, certificates, bootstrap server addresses, and other configuration settings are not hard-coded, but can be set in configuration files, or otherwise injected into your applications.</p>

<h3 id="use-the-same-certificates">Use the same certificates</h3>

<p>Consider using the same certificates for both the origin and destination clusters, by <a href="../../installing/configuring/#using-your-own-certificates">providing your own certificates at installation</a>. This allows applications to use a single certificate to access either cluster.</p>

<p><strong>Note</strong>: You must complete the process of providing your own certificates before installing an instance of Event Streams.</p>

<p><strong>Note</strong>: When providing your own certificates, ensure that certificate renewal processes are followed at both the origin and destination clusters, so that both clusters continue to use the same certificates.</p>

<h3 id="set-up-the-same-access-to-both-clusters">Set up the same access to both clusters</h3>

<p>Consider providing your applications the same access to both the origin and destination clusters. For example, you can duplicate the application <code class="language-plaintext highlighter-rouge">KafkaUser</code> credentials from the origin cluster to the destination cluster. This allows applications to use a single set of credentials to access either cluster. Use the following commands to retrieve the <code class="language-plaintext highlighter-rouge">KafkaUser</code> credentials and custom resource from the origin cluster, and then create a new <code class="language-plaintext highlighter-rouge">KafkaUser</code> with these credentials on the destination cluster:</p>
<ol>
  <li>Log in to your origin cluster. Log in to your Red Hat OpenShift Container Platform as a cluster administrator by using the <a href="https://docs.openshift.com/container-platform/4.12/cli_reference/openshift_cli/getting-started-cli.html#cli-logging-in_cli-developer-commands" target="_blank"><code class="language-plaintext highlighter-rouge">oc</code> CLI</a> (<code class="language-plaintext highlighter-rouge">oc login</code>).</li>
  <li>Run the following command to retrieve the name of the secret for the <code class="language-plaintext highlighter-rouge">KafkaUser</code>:<br />
<code class="language-plaintext highlighter-rouge">oc get kafkauser &lt;name&gt; --namespace &lt;namespace&gt; -o jsonpath='{"username: "}{.status.username}{"\nsecret-name: "}{.status.secret}{"\n"}'</code><br />
<br />
The command provides the following output:
    <ul>
      <li>The principal username</li>
      <li>The name of the Kubernetes <code class="language-plaintext highlighter-rouge">Secret</code>, which includes the namespace, containing the SCRAM password or the TLS certificates.</li>
    </ul>
  </li>
  <li>Use the <code class="language-plaintext highlighter-rouge">secret-name</code> from the previous step to run the following command. The command retrieves the credentials from the Kubernetes <code class="language-plaintext highlighter-rouge">Secret</code> and and saves them to the <code class="language-plaintext highlighter-rouge">kafkauser-secret.yaml</code> file:<br />
<code class="language-plaintext highlighter-rouge">oc get secret &lt;secret-name&gt; --namespace &lt;namespace&gt; -o yaml &gt; kafkauser-secret.yaml</code></li>
  <li>Run the following command to retrieve the <code class="language-plaintext highlighter-rouge">KafkaUser</code> custom resource YAML and save it to the <code class="language-plaintext highlighter-rouge">kafkauser.yaml</code> file:<br />
<code class="language-plaintext highlighter-rouge">oc get kafkauser &lt;name&gt; --namespace &lt;namespace&gt; -o yaml &gt; kafkauser.yaml</code></li>
  <li>Log in to your destination cluster.  Log in to your Red Hat OpenShift Container Platform as a cluster administrator by using the <a href="https://docs.openshift.com/container-platform/4.12/cli_reference/openshift_cli/getting-started-cli.html#cli-logging-in_cli-developer-commands" target="_blank"><code class="language-plaintext highlighter-rouge">oc</code> CLI</a> (<code class="language-plaintext highlighter-rouge">oc login</code>).</li>
  <li>Edit both the <code class="language-plaintext highlighter-rouge">kafkauser-secret.yaml</code> and <code class="language-plaintext highlighter-rouge">kafkauser.yaml</code> files to set the correct namespace and Event Streams cluster name for the following properties:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">metadata.namespace</code>: provide the namespace of your destination cluster.</li>
      <li><code class="language-plaintext highlighter-rouge">metadata.labels["eventstreams.ibm.com/cluster"]</code>: provide the name of your destination cluster.</li>
    </ul>
  </li>
  <li>Run the following command to create the Kubernetes <code class="language-plaintext highlighter-rouge">Secret</code> containing the <code class="language-plaintext highlighter-rouge">KafkaUser</code> credentials on the destination cluster:<br />
<code class="language-plaintext highlighter-rouge">oc apply -f kafkauser-secret.yaml</code><br />
<strong>Note</strong>: You must run this command before the creation of the <code class="language-plaintext highlighter-rouge">KafkaUser</code> to ensure the same credentials are available on both the origin and destination clusters.</li>
  <li>Run the following command to create the <code class="language-plaintext highlighter-rouge">KafkaUser</code> on the destination cluster:<br />
<code class="language-plaintext highlighter-rouge">oc apply -f kafkauser.yaml</code></li>
</ol>

<p><strong>Note</strong>: To duplicate <code class="language-plaintext highlighter-rouge">KafkaUser</code> credentials that use Mutual TLS authentication, the origin and destination cluster must be <a href="../../installing/configuring/#using-your-own-certificates">configured with the same certificates for the client CA at installation</a>.</p>

<p><strong>Note</strong>: When <code class="language-plaintext highlighter-rouge">KafkaUser</code> credentials or Access Control Lists (ACLs) are modified on the origin cluster, the changes will need to be duplicated to the destination cluster to ensure that you can still switch clusters.</p>

<h3 id="use-regular-expressions-for-consumer-topic-subscriptions">Use regular expressions for consumer topic subscriptions</h3>

<p>Geo-replicated topics on the destination cluster will have a prefix added to the topic name. The prefix is the name of the Event Streams instance on the origin cluster, as defined in the <code class="language-plaintext highlighter-rouge">EventStreams</code> custom resource, for example <code class="language-plaintext highlighter-rouge">my_origin.&lt;topic-name&gt;</code>. Consider using regular expressions to define the topics that consuming applications are subscribed to, for example <code class="language-plaintext highlighter-rouge">.*&lt;topic-name&gt;</code>.  Using a regular expression means that the topic subscription does not need to change when switching to the prefixed topic names on the destination cluster.</p>

<h3 id="plan-to-update-consumer-group-offsets">Plan to update consumer group offsets</h3>

<p>Consider how you will <a href="#updating-consumer-group-offsets">update the consumer group offsets</a> in consuming applications when switching clusters. Geo-replication includes consumer group checkpointing to store the mapping of consumer group offsets, allowing consuming applications to continue processing messages at the appropriate offset positions.</p>

<h3 id="produce-to-the-same-topic-name">Produce to the same topic name</h3>

<p>When switching clusters, produce to the same topic name on the destination cluster as was used on the origin cluster. This will ensure geo-replicated messages and directly produced messages are stored in separate topics. If consuming applications use regular expressions to subscribe to both topics, then both sets of messages will be processed.</p>

<h3 id="consider-message-ordering">Consider message ordering</h3>

<p>If message ordering is required, configure your consuming applications to process all messages from the geo-replicated topic on the destination cluster before producing applications are restarted.</p>

<h2 id="updating-existing-applications-to-use-geo-replicated-topics-on-the-destination-cluster">Updating existing applications to use geo-replicated topics on the destination cluster</h2>

<p>If you are not using the same certificates and credentials on the origin and destination clusters, use the following instructions to retrieve the information required to update your applications so that they can use the geo-replicated topics from the destination cluster:</p>

<ol>
  <li>Log in to your destination Event Streams cluster as an administrator.</li>
  <li>Click <strong>Connect to this cluster</strong>.</li>
  <li>Go to the <strong>Resources</strong> tab, and use the information on the page to change your client application settings to use the geo-replicated topic on the destination cluster. You need the following information to do this:<br />
    <ul>
      <li><strong>Bootstrap server</strong>: In the <strong>Kafka listener and credentials</strong> section, select the listener from the list.
        <ul>
          <li>Click the <strong>External</strong> tab for applications connecting from outside of the OpenShift Container Platform cluster.</li>
          <li>Click the <strong>Internal</strong> tab for applications connecting from inside the OpenShift Container Platform cluster.</li>
        </ul>
      </li>
      <li><strong>Credentials</strong>: To connect securely to Event Streams, your application needs credentials with permission to access the cluster and resources such as topics. In the <strong>Kafka listener and credentials</strong> section, click the <strong>Generate SCRAM credentials</strong> or <strong>Generate TLS credentials</strong> button next to the listener you are using, and follow the instructions to select the level of access you want to grant to your resources with the credentials.</li>
      <li><strong>Certificates</strong>: A certificate is required by your client applications to connect securely to the destination cluster. In the <strong>Certificates</strong> section, download either the PKCS12 certificate or PEM certificate. If you use the PKCS12 certificate, make a copy of the <strong>Certificate password</strong> to use with the certificate in your application.</li>
    </ul>
  </li>
</ol>

<p>After the connection is configured, your client application can continue to operate using the geo-replicated topics on the destination cluster.</p>

<h2 id="updating-consumer-group-offsets">Updating consumer group offsets</h2>

<p>The topic on the origin cluster and the geo-replicated topic on the destination cluster might have different offsets for the same messages, depending on when geo-replication started. This means that a consuming application that is switched to use the destination cluster cannot use the consumer group offset from the origin cluster.</p>

<h3 id="updating-consumer-group-offsets-by-using-checkpoints">Updating consumer group offsets by using checkpoints</h3>

<p>Geo-replication uses the Kafka Mirror Maker 2.0 <code class="language-plaintext highlighter-rouge">MirrorCheckpointConnector</code> to automatically store consumer group offset checkpoints for all origin cluster consumer groups. Each checkpoint maps the last committed offset for each consumer group in the origin cluster to the equivalent offset in the destination cluster. The checkpoints are stored in the <code class="language-plaintext highlighter-rouge">&lt;origin_cluster_name&gt;.checkpoints.internal</code> topic on the destination cluster.</p>

<p><strong>Note</strong>: Consumer offset checkpoint topics are internal topics that are not displayed in the UI and CLI. Run the following CLI command to include internal topics in the topic listing:<br />
<code class="language-plaintext highlighter-rouge">cloudctl es topics --internal</code>.</p>

<p>When processing messages from the destination cluster, you can use the checkpoints to start consuming from an offset that is equivalent to the last committed offset on the origin cluster. If your application is written in Java, Kafkas <a href="https://kafka.apache.org/25/javadoc/index.html?org/apache/kafka/connect/mirror/RemoteClusterUtils.html" target="_blank"><code class="language-plaintext highlighter-rouge">RemoteClusterUtils</code></a> class provides the <code class="language-plaintext highlighter-rouge">translateOffsets()</code> utility method to retrieve the destination cluster offsets for a consumer group from the checkpoints topic. You can then use the <code class="language-plaintext highlighter-rouge">KafkaConsumer.seek()</code> method to override the offsets that the consumer will use on the next <code class="language-plaintext highlighter-rouge">poll</code>.</p>

<p>For example, the following Java code snippet will update the <code class="language-plaintext highlighter-rouge">example-group</code> consumer group offset from the <code class="language-plaintext highlighter-rouge">origin-cluster</code> cluster to the destination cluster equivalent:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Retrieve the mapped offsets for the destination cluster topic-partitions
Map&lt;TopicPartition, OffsetAndMetadata&gt; destinationOffsetsMap = RemoteClusterUtils.translateOffsets(properties, "origin-cluster",
        "example-group", Duration.ofMillis(10000));

// Update the KafkaConsumer to start at the mapped offsets for every topic-partition
destinationOffsetsMap.forEach((topicPartition, offsetAndMetadata) -&gt; kafkaConsumer.seek(topicPartition, offsetAndMetadata));

// Retrieve records from the destination cluster, starting from the mapped offsets
ConsumerRecords&lt;byte[], byte[]&gt; records = kafkaConsumer.poll(Duration.ofMillis(10000))
</code></pre></div></div>

<p><strong>Note</strong>: To configure how often checkpoints are stored and which consumer groups are stored in the checkpoints topic, you can edit the following properties in your Kafka Mirror Maker 2 custom resource:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">spec.mirror.checkpointConnector.config</code></li>
  <li><code class="language-plaintext highlighter-rouge">spec.mirror.groupsPattern</code></li>
</ul>

<h3 id="updating-consumer-group-offsets-manually">Updating consumer group offsets manually</h3>

<p>If you want your client application to continue processing messages on the destination cluster from the point they reached on the topic on the origin cluster, or if you want your client application to start processing messages from the beginning of the topic, you can use the <code class="language-plaintext highlighter-rouge">cloudctl es group-reset</code> command.</p>

<ul>
  <li>To continue processing messages from the point they reached on the topic on the origin cluster, you can specify the offset for the consumer group that your client application is using:<br />
    <ol>
      <li>Log in to your cluster as an administrator by using the IBM Cloud Pak CLI:<br /> <code class="language-plaintext highlighter-rouge">cloudctl login -a https://&lt;cluster_address&gt;:&lt;cluster_router_https_port&gt;</code></li>
      <li>Run the following command to initialize the Event Streams CLI on the cluster:<br />
<code class="language-plaintext highlighter-rouge">cloudctl es init</code></li>
      <li>Run the <code class="language-plaintext highlighter-rouge">cloudctl es group-reset</code> command as follows:
<br />
<code class="language-plaintext highlighter-rouge">cloudctl es group-reset --group &lt;your-consumer-group-id&gt; --topic &lt;topic-name&gt; --mode datetime --value &lt;timestamp&gt;</code><br />
<br />
For example, the following command instructs the applications in consumer group <code class="language-plaintext highlighter-rouge">consumer-group-1</code> to start consuming messages with timestamps from after midday on 28th September 2018:<br />
<br />
<code class="language-plaintext highlighter-rouge">cloudctl es group-reset --group consumer-group-1 --topic GEOREPLICATED.TOPIC --mode datetime --value 2018-09-28T12:00:00+00:00 --execute</code></li>
    </ol>
  </li>
  <li>To start processing messages from the beginning of the topic, you can use the <code class="language-plaintext highlighter-rouge">--mode earliest</code> option, for example:<br />
<code class="language-plaintext highlighter-rouge">cloudctl es group-reset --group consumer-group-1 --topic GEOREPLICATED.TOPIC --mode earliest --execute</code></li>
</ul>

<p>These methods also avoid the need to make code changes to your client application.</p>

<h2 id="reverting-message-production-and-consumption-back-to-the-origin-cluster">Reverting message production and consumption back to the origin cluster</h2>

<p>When the origin Event Streams cluster becomes available again, you can switch your client applications   back to use the topics on your origin cluster. If messages have been produced directly to the destination cluster, use the following steps to replicate those messages to the origin cluster before switching back to using it.</p>
<ul>
  <li><a href="../planning">Create an <code class="language-plaintext highlighter-rouge">EventStreamsGeoReplicator</code> custom resource</a> configured to connect to the origin Event Streams cluster, and set up geo-replication in the reverse direction to the original geo-replication flow. This means there will be a geo-replicator running on the origin cluster which copies messages from non-geo-replicated topics on the destination cluster back to geo-replicated topics on the origin cluster.</li>
  <li>The geo-replicated topic named <code class="language-plaintext highlighter-rouge">&lt;origin-cluster&gt;.&lt;topic&gt;</code> on the destination cluster will not have new geo-replicated messages arriving, as the producing applications have been switched to produce messages directly to the topic without a prefix on the destination cluster. Ensure that the geo-replicated topic on the destination cluster is not geo-replicated back to the origin cluster as this will result in duplicate data on the origin cluster.</li>
  <li>Switch the producing and consuming applications back to the origin cluster again by following the <a href="#preparing-clusters-and-applications-for-switching">previous instructions</a>. Producing applications will continue to produce messages to the original topic name on the origin cluster, and consuming applications will read from both the geo-replicated topics and the original topics on the origin cluster. Consuming applications will need their <a href="#updating-consumer-group-offsets">consumer group offsets to be correctly updated</a> for the offset positions on the origin cluster.</li>
</ul>

<p><strong>Note</strong>: Due to the asynchronous nature of geo-replication, there might be messages in the original topics on the origin cluster that had not been geo-replicated over to the destination cluster when the origin cluster became unavailable. You will need to decide how to handle these messages. Consider setting consumer group offsets so that the messages are processed, or ignore the messages by setting consumer group offsets to the latest offset positions in the topic.</p>

<p>For example, if the origin cluster is named <code class="language-plaintext highlighter-rouge">my_origin</code>, the destination cluster is named <code class="language-plaintext highlighter-rouge">my_destination</code>, and the topic on the <code class="language-plaintext highlighter-rouge">my_origin</code> cluster is named <code class="language-plaintext highlighter-rouge">my_topic</code>, then the geo-replicated topic on the <code class="language-plaintext highlighter-rouge">my_destination</code> cluster will be named <code class="language-plaintext highlighter-rouge">my_origin.my_topic</code>.</p>
<ul>
  <li>When the <code class="language-plaintext highlighter-rouge">my_origin</code> cluster becomes unavailable, producing applications are switched to the <code class="language-plaintext highlighter-rouge">my_destination</code> cluster. The <code class="language-plaintext highlighter-rouge">my_destination</code> cluster now has topics named <code class="language-plaintext highlighter-rouge">my_topic</code> and <code class="language-plaintext highlighter-rouge">my_origin.my_topic</code>. Consuming applications are also switched to the <code class="language-plaintext highlighter-rouge">my_destination</code> cluster and use the regular expression <code class="language-plaintext highlighter-rouge">.*my_topic</code> to consume from both topics.</li>
  <li>When the <code class="language-plaintext highlighter-rouge">my_origin</code> cluster becomes available again, reverse geo-replication is set up between the clusters. The <code class="language-plaintext highlighter-rouge">my_origin</code> cluster now has the topic named <code class="language-plaintext highlighter-rouge">my_topic</code> and a new geo-replicated topic named <code class="language-plaintext highlighter-rouge">my_destination.my_topic</code>. The topic named <code class="language-plaintext highlighter-rouge">my_destination.my_topic</code> contains the messages that were produced directly to the <code class="language-plaintext highlighter-rouge">my_destination</code> cluster.</li>
  <li>Producing applications are producing to the topic named <code class="language-plaintext highlighter-rouge">my_topic</code> on the <code class="language-plaintext highlighter-rouge">my_destination</code> cluster, so the geo-replicated topic named <code class="language-plaintext highlighter-rouge">my_origin.my_topic</code> on the <code class="language-plaintext highlighter-rouge">my_destination</code> cluster does not have any new messages arriving. Existing messages in the topic named <code class="language-plaintext highlighter-rouge">my_origin.my_topic</code> are consumed from the <code class="language-plaintext highlighter-rouge">my_destination</code> cluster until there is no more processing of the messages required.<br />
 <strong>Note:</strong> The geo-replicated topic named <code class="language-plaintext highlighter-rouge">my_origin.my_topic</code> is not included in the reverse geo-replication back to the <code class="language-plaintext highlighter-rouge">my_origin</code> cluster, as that would create a geo-replicated topic named <code class="language-plaintext highlighter-rouge">my_destination.my_origin.my_topic</code> on the <code class="language-plaintext highlighter-rouge">my_origin</code> cluster containing the same messages as in the topic named <code class="language-plaintext highlighter-rouge">my_topic</code>.</li>
  <li>Producing applications are now switched back to the <code class="language-plaintext highlighter-rouge">my_origin</code> cluster, continuing to produce to the topic named <code class="language-plaintext highlighter-rouge">my_topic</code>.</li>
  <li>Consuming applications are also switched back to the <code class="language-plaintext highlighter-rouge">my_origin</code> cluster, with consumer group offsets updated for the offset positions at the <code class="language-plaintext highlighter-rouge">my_origin</code> cluster. Consuming applications continue to use the regular expression <code class="language-plaintext highlighter-rouge">.*my_topic</code> to consume from both the topic named <code class="language-plaintext highlighter-rouge">my_topic</code> and the geo-replicated topic named <code class="language-plaintext highlighter-rouge">my_destination.my_topic</code>.</li>
</ul>

          </div>


          
        </section>

        <aside class="sidebar__right ">
          
          <div class="fixedSidebar">
            <nav class="toc">
              <ul class="toc__menu">
  <li><a href="#preparing-clusters-and-applications-for-switching">Preparing clusters and applications for switching</a>
    <ul>
      <li><a href="#configure-your-applications-for-switching">Configure your applications for switching</a></li>
      <li><a href="#use-the-same-certificates">Use the same certificates</a></li>
      <li><a href="#set-up-the-same-access-to-both-clusters">Set up the same access to both clusters</a></li>
      <li><a href="#use-regular-expressions-for-consumer-topic-subscriptions">Use regular expressions for consumer topic subscriptions</a></li>
      <li><a href="#plan-to-update-consumer-group-offsets">Plan to update consumer group offsets</a></li>
      <li><a href="#produce-to-the-same-topic-name">Produce to the same topic name</a></li>
      <li><a href="#consider-message-ordering">Consider message ordering</a></li>
    </ul>
  </li>
  <li><a href="#updating-existing-applications-to-use-geo-replicated-topics-on-the-destination-cluster">Updating existing applications to use geo-replicated topics on the destination cluster</a></li>
  <li><a href="#updating-consumer-group-offsets">Updating consumer group offsets</a>
    <ul>
      <li><a href="#updating-consumer-group-offsets-by-using-checkpoints">Updating consumer group offsets by using checkpoints</a></li>
      <li><a href="#updating-consumer-group-offsets-manually">Updating consumer group offsets manually</a></li>
    </ul>
  </li>
  <li><a href="#reverting-message-production-and-consumption-back-to-the-origin-cluster">Reverting message production and consumption back to the origin cluster</a></li>
</ul>
            </nav>
          </div>
          
        </aside>


      </div>
      <div class="pageEnd">
        
          
  <nav class="pagination">
    
      <div class="previous" onclick="window.open('/event-automation/es/es_10.5/georeplication/health/','_self')">
        <div class="container">
          <a href="/event-automation/es/es_10.5/georeplication/health/" class="pagination--pager" title="Previous Item: Monitoring and managing geo-replication
">Previous</a>
          <h2 class="titlePreview">Monitoring and managing geo-replication
</h2>
        </div>
      </div>
    
    
      <div class="next" onclick="window.open('/event-automation/es/es_10.5/connecting/rest-api/','_self')">
        <div class="container">
          <a href="/event-automation/es/es_10.5/connecting/rest-api/" class="pagination--pager" title="Next Item: Event Streams producer API
">Next</a>
          <h2 class="titlePreview">Event Streams producer API
</h2>
        </div>
      </div>
      
  </nav>

        
      </div>
    </div>


  </div> <!-- Main content -->

</main></div>


    
      <div class="page__footer">
          <footer>
            <!-- start custom footer snippets -->

<!-- end custom footer snippets -->

            
<div class="page__footer-copyright"><a href="https://www.ibm.com/privacy/us/en/" rel="nofollow" target="_blank">Privacy Policy</a>  &nbsp; Copyright IBM Corporation 2023</br>
<a href="http://localhost:4000/event-automation/accessibility/" rel="nofollow" target="_blank">Accessibility</a> </br> <a href="http://localhost:4000/event-automation/notices/" rel="nofollow" target="_blank">Notices</a></br>
          </footer>
      </div>      
    


    
  <script src="/event-automation/assets/js/main.min.js"></script>
  <!-- <script src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script> -->






<script src="/event-automation/assets/js/design.js"></script>





<script src="/event-automation/assets/js/lunr/lunr.min.js"></script>
<script src="/event-automation/assets/js/lunr/lunr-store.js"></script>
<script src="/event-automation/assets/js/lunr/lunr-en.js"></script>





    

    
  </body>
</html>
